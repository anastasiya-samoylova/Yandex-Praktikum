# ML, Временные ряды,  Прогнозирование количества заказов такси 

## Описание проекта

Компания такси собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час.

**Цель проекта**:создать модель для прогнозирования количество заказов такси на следующий час.
Критерий успешности модели: значение метрики *RMSE* на тестовой выборке должно быть не более 48.



## Ход исследования


1. Загрузка данных и ресемплирование данных по одному часу.
2. Анализ данных.
3. Обучение моделей, подобор гиперпараметры кросс-валидацией. 
- LinearRegression
- RandomForestRegression
- LightGBM
- CatBoost
4. Проверка лучшей модели на тестовой выборке (10% от исходных данных)


## Выводы по результатам проекта

Выводы по результатам анализа исходных данных:
- Тренд идет на явное возрастание, то есть он не стационарный - это видно и на графике тренда, и на графике ресемплированных по 1 часу данных. Даже если убрать тренд и сезонность, то на графике остатков все равно видны всплески.
- Есть явная суточная сезонность - больше всего заказов 09:00 и 00:00, меньше всего в районе 06:00 и 18:00.
- Дни по кол-ву заказов отличаются друг от друга.

Добавлены дополнительные признаки для обучения модели:
- **День недели** - так как видна зависимость от дня недеди на графике тренда за месяц;
- **Час** - цель: предсказать данные на определнный час, поэтому час - необходимый признак;
- **lag** (сдвиг, разности временного ряда);
- **rolling_mean** (скользящее среднее).


Выбрана лучшая модель *RandomForestRegression*,  на тестовых данных имеет метрику RMSE равной 45.94. Это удовлетворяет условием проекта.

Таким образом для прогнозирования количество заказов такси на следующий час, рекомендуем использовать модель RandomForestRegression с гиперпараметрами:

max_depth: 17,
n_estimators: 501.



[Тетрадка проекта](https://github.com/anastasiya-samoylova/Yandex-Praktikum/blob/main/n10_ml_forecast_taxi_orders/ml_forecast_taxi_orders.ipynb)
