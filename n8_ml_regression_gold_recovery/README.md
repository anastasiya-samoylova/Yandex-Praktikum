# ML, Регрессия,  Предсказание коэффициента восстановления золота

## Описание проекта


**Цель проекта**  - создание прототипа модели машинного обучения для компании, которая разрабатывает решения для эффективной работы промышленных предприятий.

Наша модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Для исследования и обучения модели нам предоставлены данные с параметрами добычи и очистки. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Краткий план проекта:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.


## Ход исследования

1.  Предобработка данных
2.  Проверка расчета эффективности
3.  Анализ данных
- Изменение концентрации металлов (Au, Ag, Pb) на различных этапах очистки
- Сравнение распределения размеров гранул сырья на обучающей и тестовой выборках
- Сравнение размеров гранул сырья до флотации
-  Сравнение размеров гранул сырья перед первым этапом очистки
3.  Подбор модели 
-  Функция для вычисления итоговой sMAPE
-  Обучение моделей и оценка их качества кросс-валидацией
-  Выбор лучшей модели и проверка её на тестовой выборке
-  Сравнение с константной моделью 

## Выводы по результатам проекта


1. Проверили, что эффективность обогащения рассчитана правильно, т.к. `MAE` между нашими расчётами и значением признака стремится к нулю.

2.  В тестовой выборке отсутствуют признаки, которые невозможно получить/измерить во время выполнения технологического процесса ( "отвальные хвосты" (`tail`) и концентраты (`concentrate`) на всех этапах, некоторые расчетные (`calculation`) и выходные (`output`) характеристики процесса). Также в тестовой выборке отсутствовали целевые признаки.

3. Провели предобработку данных, удалив из исходных данных строки без целевого признака и из тествой и обучающей выборок строки с пустыми признаками.

4. Проанализировали изменение концентрация металлов (`Au`, `Ag`, `Pb`) на различных этапах очистки. На финальной стадии очень много выбросов. Больше всего выбросов наблюдается у золота как на первычной очистке, так и на финальной очистке. Еще можно выделить возрастание концентрации золота на финальной очистке.

5. При сравнении распределения размеров гранул сырья на обучающей и тестовой выборках сделали вывод, что распределение обучающей и тестовой выборки можно считать близкими по значению,  они практически совпадают.

6. Исследовали суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах. Суммарная концентрация веществ увеличивается с течением процесса обогащения (колокол как бы сдвигается вправо по шкале), что закономерно, т.к. при обработке вымываются лишние примеси и подсадочные реагенты.

7. Написали функцию для вычисления `sMAPE` (симметричного среднего абсолютного процентного отклонения).

8. Подобрали лучшую модель и оченили ее качество кросс-валидацией. Лучша модель - `RandomForestRegression`. 
